<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Reef Rangers</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body class="home">
    <!-- Sign out X -->
    <a id="close" href="index.html" onclick="signOut()">âœ•</a>
    <div id="app">
      <!-- Top currency -->
      <div id="currency-container">
        <a class="apple-glass currency" href="#">
          <span class="emoji" id="streak">ğŸ„ 0 Day Streak</span>
        </a>
        <a class="apple-glass currency" href="#">
          <span class="emoji" id="seashells">ğŸš 0 Seashells</span>
        </a>
      </div>

      <!-- Creature -->
      <div id="creature-info">
        <div id="creature-name"></div>
        <div class="hp-bar"><div id="creature-hp" class="hp-fill"></div></div>
        <div id="creature-stats" class="stats"></div>
      </div>
      <div id="creature-container">
        <img src="../images/shellfin.png" alt="Creature Sprite" />
      </div>

      <!-- Bottom nav -->
      <div class="nav-row">
        <a class="apple-glass nav-block nav-item" href="mission.html" id="mission-link">
          <span class="emoji">ğŸ¤¿</span>
          <span class="text">Mission</span>
        </a>
        <a class="apple-glass nav-block nav-item" href="#" id="market-link">
          <span class="emoji">ğŸª¸</span>
          <span class="text">Market</span>
        </a>
      </div>
      
      

    <script src="../js/userData.js"></script>
    <script>
      const user = getCurrentUser();
      if (user) {
        const now = Date.now();
        const oneDay = 24 * 60 * 60 * 1000;
        let { signInStreak, lastSignIn } = user;
        if (!lastSignIn || now - lastSignIn >= oneDay) {
          signInStreak += 1;
          lastSignIn = now;
          updateCurrentUser({ signInStreak, lastSignIn });
        }
        document.getElementById("streak").textContent =
          `ğŸ”± ${signInStreak} Day Streak`;
        document.getElementById("seashells").textContent =
          `ğŸš ${user.seashells} Seashells`;
        if (user.creatures && user.creatures.length > 0) {
          const c = user.creatures[0];
          const nameEl = document.getElementById("creature-name");
          if (nameEl) nameEl.textContent = c.name;
          const hpEl = document.getElementById("creature-hp");
          if (hpEl) hpEl.style.width = "50%";
          const statsEl = document.getElementById("creature-stats");
          if (statsEl)
            statsEl.textContent = `HP: ${c.hp}/${c.hp} | ATK: ${c.attack}`;
          const imgEl = document.querySelector("#creature-container img");
          if (imgEl && c.sprite && c.sprite.normal)
            imgEl.src = c.sprite.normal;
        }

      const missionLink = document.getElementById("mission-link");
      if (missionLink) {
        missionLink.addEventListener("click", (e) => {
          e.preventDefault();
          window.location.href = "mission.html";
        });
      }
      } else {
        window.location.href = "index.html";
      }
    </script>
    <script src="../js/bubbles.js"></script>
  </body>
</html>
