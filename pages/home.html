<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Reef Rangers</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body class="home">
    <!-- Sign out X -->
    <a id="close" href="index.html" onclick="signOut()">âœ•</a>
    <div id="app">
      <!-- Top currency -->
      <div id="currency-container">
        <div class="apple-glass currency">
          <span class="emoji" id="streak">ğŸ„ 0 Day Streak</span>
        </div>
        <div class="apple-glass currency">
          <span class="emoji" id="seashells">ğŸš 0 Seashells</span>
        </div>
      </div>

      <!-- Creature -->
      <div id="creature-info"></div>
      <div id="creature-container">
        <img src="../images/shellfin.png" alt="Creature Sprite" />
      </div>

      <!-- Bottom nav -->
        <div class="apple-glass" id="nav">
          <a class="nav-item" href="mission.html" id="mission-link">
            <span class="emoji">ğŸ¤¿</span>
            <span class="text">Mission</span>
          </a>
        </div>
          <div class="apple-glass" id="nav">
            <a class="nav-item" href="mission.html" id="mission-link">
              <span class="emoji">ğŸ¤¿</span>
              <span class="text">Mission</span>
            </a>
          </div>
    </div>

    <script src="../js/userData.js"></script>
    <script>
      const user = getCurrentUser();
      if (user) {
        const now = Date.now();
        const oneDay = 24 * 60 * 60 * 1000;
        let { signInStreak, lastSignIn } = user;
        if (!lastSignIn || now - lastSignIn >= oneDay) {
          signInStreak += 1;
          lastSignIn = now;
          updateCurrentUser({ signInStreak, lastSignIn });
        }
        document.getElementById("streak").textContent =
          `ğŸ”± ${signInStreak} Day Streak`;
        document.getElementById("seashells").textContent =
          `ğŸš ${user.seashells} Seashells`;
        if (user.creatures && user.creatures.length > 0) {
          const c = user.creatures[0];
          const infoEl = document.getElementById("creature-info");
          if (infoEl) infoEl.textContent = c.name;
          const imgEl = document.querySelector("#creature-container img");
          if (imgEl && c.sprite && c.sprite.normal)
            imgEl.src = c.sprite.normal;
        }

      const missionLink = document.getElementById("mission-link");
      if (missionLink) {
        missionLink.addEventListener("click", (e) => {
          e.preventDefault();
          window.location.href = "mission.html";
        });
      }
      } else {
        window.location.href = "index.html";
      }
    </script>
    <script src="../js/bubbles.js"></script>
  </body>
</html>
